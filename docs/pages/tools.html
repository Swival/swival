<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Tools — Swival</title>
    <meta name="description" content="Tools — Swival documentation">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Tools — Swival">
    <meta property="og:description" content="Tools — Swival documentation">
    <meta property="og:image" content="https://swival.dev/img/logo.png">
    <meta property="og:url" content="https://swival.dev/pages/tools.html">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Tools — Swival">
    <meta name="twitter:description" content="Tools — Swival documentation">
    <meta name="twitter:image" content="https://swival.dev/img/logo.png">
    <link rel="icon" href="../favicon.ico">
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    <header class="site-header">
        <div class="header-inner">
            <a href="../" class="header-logo">
                <img src="../img/logo.png" alt="Swival">
            </a>
            <nav class="header-nav">
                <a href="./">Docs</a>
                <a href="https://github.com/swival/swival">GitHub</a>
            </nav>
        </div>
    </header>
    <div class="docs-layout">
        <aside class="sidebar">
            <div class="sidebar-section">
<h4>Basics</h4>
<ul>
<li><a href="getting-started.html">Getting Started</a></li>
<li><a href="usage.html">Usage</a></li>
<li><a href="tools.html" class="active">Tools</a></li>
<li><a href="context-management.html">Context Management</a></li>
</ul>
</div>
<div class="sidebar-section">
<h4>Configuration & Deployment</h4>
<ul>
<li><a href="safety-and-sandboxing.html">Safety & Sandboxing</a></li>
<li><a href="skills.html">Skills</a></li>
<li><a href="mcp.html">MCP</a></li>
<li><a href="customization.html">Customization</a></li>
<li><a href="providers.html">Providers</a></li>
<li><a href="reports.html">Reports</a></li>
<li><a href="reviews.html">Reviews</a></li>
<li><a href="agentfs.html">AgentFS</a></li>
</ul>
</div>
        </aside>
        <article class="docs-content">
            <h1 id="tools">Tools</h1>
<p>Swival gives the model a fixed set of tools at runtime. Most tools are always available. <code>run_command</code> appears only when you enable command execution with <code>--allowed-commands</code> or <code>--yolo</code>, <code>use_skill</code> appears only when skills are discovered, and MCP tools appear when external MCP servers are configured.</p>
<h2 id="read_file"><code>read_file</code></h2>
<p><code>read_file</code> can read text files and directory listings inside allowed roots. File output is line-numbered, which makes later edits precise. The default window starts at <code>offset=1</code> with <code>limit=2000</code> lines.</p>
<p>If output is truncated, Swival appends a continuation hint with the next offset. You can also request <code>tail=N</code> to start from the end of the file, which is useful for logs.</p>
<p>Large responses are capped at 50 KB per call, and individual long lines are truncated at 2,000 characters. Directory reads return sorted entries and mark subdirectories with a trailing <code>/</code>.</p>
<h2 id="write_file"><code>write_file</code></h2>
<p><code>write_file</code> creates or overwrites files and automatically creates missing parent directories. It supports two mutually exclusive modes. In normal write mode, you provide <code>content</code>. In move mode, you provide <code>move_from</code> and Swival performs an atomic rename when possible.</p>
<p>When <code>move_from</code> is used and no <code>content</code> is provided, Swival moves the source path to the destination path without copying text content. This supports non-text files and symlinks as well. If the destination already exists, the read-before-write guard still applies to that destination, while the source path is exempt because rename does not modify source content.</p>
<h2 id="edit_file"><code>edit_file</code></h2>
<p><code>edit_file</code> is the main incremental editing tool. It replaces <code>old_string</code> with <code>new_string</code> in an existing file and supports <code>replace_all</code> when you intentionally want multiple replacements.</p>
<p>Matching is done in three passes. Swival tries an exact string match first. If that fails, it retries with per-line trimmed matching so leading and trailing whitespace differences do not break the edit. If that still fails, it retries with Unicode normalization so smart quotes, em dashes, and ellipsis variants map to ASCII equivalents. If multiple matches are found and <code>replace_all</code> is false, the call fails to prevent accidental bulk edits.</p>
<h2 id="delete_file"><code>delete_file</code></h2>
<p><code>delete_file</code> is a soft delete. Instead of removing files permanently, Swival moves them into <code>.swival/trash/&lt;trash_id&gt;/</code> and appends metadata to <code>.swival/trash/index.jsonl</code>. Directories are not allowed.</p>
<p>Trash retention is enforced automatically. Entries older than seven days are removed, and total trash size is capped at 50 MB with oldest-first eviction when needed.</p>
<h2 id="list_files"><code>list_files</code></h2>
<p><code>list_files</code> recursively evaluates glob patterns such as <code>**/*.py</code> and returns matches sorted by file modification time, newest first. Results are capped at 100 files and output is still bounded by the same 50 KB response cap.</p>
<h2 id="grep"><code>grep</code></h2>
<p><code>grep</code> searches file contents with Python regular expressions. Matches are grouped by file, include line numbers, and are sorted by file recency so the newest files are surfaced first. You can narrow by directory with <code>path</code> and by filename glob with <code>include</code> (supports <code>**/*.ext</code> patterns).</p>
<p>Set <code>case_insensitive</code> to <code>true</code> for case-insensitive matching. Results are capped at 100 matches and long lines are truncated to 2,000 characters.</p>
<h2 id="think"><code>think</code></h2>
<p><code>think</code> is structured scratchpad reasoning. It lets the model capture numbered thoughts, revise earlier thoughts, and branch from a prior thought to compare alternative approaches. This is especially helpful for debugging and multi-step refactors.</p>
<p>The only required parameter is <code>thought</code>. Everything else is optional. A <code>mode</code> parameter (<code>"new"</code>, <code>"revision"</code>, <code>"branch"</code>) selects the type of thought. Revision mode requires <code>revises_thought</code> to reference an earlier thought number. Branch mode requires <code>branch_from_thought</code> plus a <code>branch_id</code> label.</p>
<p>The tool applies tolerant coercion so models that send extra or contradictory fields don't get stuck in validation loops. Incompatible fields are stripped based on the inferred mode, and corrective error messages include valid thought numbers when a reference is wrong.</p>
<h2 id="todo"><code>todo</code></h2>
<p><code>todo</code> tracks work items during a run. The list is stored in <code>.swival/todo.md</code>, so the agent can recover state even after context compaction. Actions include <code>add</code>, <code>done</code>, <code>remove</code>, <code>clear</code>, and <code>list</code>, and each action returns the full current list.</p>
<p>Matching for <code>done</code> and <code>remove</code> is fuzzy in a controlled way, so exact wording is not required every time. Swival tries exact matching first, then prefix matching, then substring matching. The list allows up to 50 items, and each item can be up to 500 characters.</p>
<h2 id="history-logging">History Logging</h2>
<p>Every final answer is appended to <code>.swival/HISTORY.md</code> with a timestamp and the originating question. This file is capped at 500 KB. Once full, new entries are skipped instead of rotating older content. Use <code>--no-history</code> if you do not want history writes.</p>
<h2 id="fetch_url"><code>fetch_url</code></h2>
<p><code>fetch_url</code> downloads HTTP or HTTPS content and returns it as markdown, plain text, or raw HTML. It is designed for documentation lookup and API reference pulls. Binary content types are rejected.</p>
<p>Raw response bodies are capped at 5 MB, and inline output is capped at 50 KB. Larger converted outputs are saved under <code>.swival/</code> so the agent can page through them with <code>read_file</code>.</p>
<p>SSRF protections are built in. Swival resolves every URL in the redirect chain and blocks private, loopback, link-local, and reserved addresses.</p>
<h2 id="run_command"><code>run_command</code></h2>
<p><code>run_command</code> is disabled by default. You can enable it with a whitelist.</p>
<pre><code class="language-sh">swival --allowed-commands ls,git,python3 &quot;Run the tests&quot;
</code></pre>
<p>In whitelist mode, the command must be passed as an array of arguments, not as a shell string. Swival resolves each allowed command to an absolute path at startup and rejects commands that resolve inside the base directory, so the model cannot edit and execute workspace scripts in one loop.</p>
<p>Timeout defaults to 30 seconds and is clamped to a maximum of 120 seconds. Inline command output is capped at 10 KB. Larger output is written to <code>.swival/cmd_output_*.txt</code> and hard-capped at 1 MB before writing to disk. Those files are cleaned up automatically after roughly ten minutes.</p>
<p>In YOLO mode, command execution is unrestricted and Swival also accepts shell command strings through <code>/bin/sh -c</code> on Unix or <code>cmd.exe /c</code> on Windows.</p>
<h2 id="use_skill"><code>use_skill</code></h2>
<p>When skills are discovered, Swival exposes <code>use_skill</code> so the model can load full instructions on demand. The system prompt only includes a compact skill catalog at startup, and full skill instructions are injected only when the tool is called. This keeps the default prompt smaller while still allowing rich task-specific guidance.</p>
<h2 id="snapshot"><code>snapshot</code></h2>
<p><code>snapshot</code> is a context management tool for collapsing exploration into compact summaries. When the model spends many turns reading files, grepping, and reasoning before arriving at a conclusion, <code>snapshot</code> lets it collapse all of that into a single short message so the context window stays clean for the actual work. For the full picture of how this fits into Swival's context management architecture, see <a href="context-management.html">Context Management</a>.</p>
<p>The tool supports four actions: <code>save</code>, <code>restore</code>, <code>cancel</code>, and <code>status</code>.</p>
<p><code>save</code> sets an explicit checkpoint to mark the start of a focused investigation. It takes a required <code>label</code> parameter (max 100 characters). Only one explicit checkpoint can exist at a time.</p>
<p><code>restore</code> collapses all turns since the checkpoint into a single summary message. It takes a required <code>summary</code> parameter (max 4,000 characters) and an optional <code>force</code> parameter that defaults to false. If no explicit checkpoint exists, it collapses from the last implicit checkpoint instead.</p>
<p><code>cancel</code> clears the explicit checkpoint without collapsing anything. <code>status</code> reports the current checkpoint state, dirty status, and history.</p>
<h3 id="implicit-checkpoints">Implicit Checkpoints</h3>
<p>Calling <code>save</code> before <code>restore</code> is not required. The system automatically creates implicit checkpoints at every user message, after each successful restore, and on conversation reset. When <code>restore</code> is called without a prior <code>save</code>, it collapses everything since the last implicit checkpoint, which is typically the most recent user message.</p>
<h3 id="dirty-scopes">Dirty Scopes</h3>
<p>Tools are classified as read-only or mutating. Read-only tools (<code>read_file</code>, <code>list_files</code>, <code>grep</code>, <code>glob</code>, <code>fetch_url</code>, <code>think</code>, <code>todo</code>, <code>snapshot</code>) are safe to collapse because they don't change anything on disk. Mutating tools (<code>write_file</code>, <code>edit_file</code>, <code>delete_file</code>, <code>run_command</code>, and unknown MCP tools) dirty the scope.</p>
<p>If the scope contains mutating tool calls, <code>restore</code> fails with a list of the dirty tools. Pass <code>force=true</code> to override when you are confident the summary captures the mutations.</p>
<h3 id="snapshot-history">Snapshot History</h3>
<p>Completed snapshots are preserved across context compaction. Up to 10 past summaries are retained and injected into the system prompt so knowledge survives aggressive compaction.</p>
<p>The collapsed message that replaces all intermediate turns looks like this:</p>
<pre><code>[snapshot: &lt;label&gt;]
&lt;your summary&gt;
(collapsed N turns, saved ~K tokens)
</code></pre>
<h3 id="repl-commands">REPL Commands</h3>
<p>In REPL mode, you can also trigger snapshots manually with <code>/save</code>, <code>/restore</code>, and <code>/unsave</code>. These work like the tool actions but are initiated by the user instead of the model. <code>/restore</code> auto-generates the summary by calling the LLM, so you don't need to write one yourself. See <a href="usage.html">Usage</a> for details.</p>
<h3 id="example-workflow">Example Workflow</h3>
<ol>
<li>User asks to debug a performance issue.</li>
<li>Agent reads six files, greps for bottlenecks, thinks through options.</li>
<li>Agent calls <code>snapshot</code> with <code>action=restore</code> and <code>summary="Bottleneck is in db/queries.py:89. The get_users() query does N+1 selects. Fix: add .select_related('profile') to the queryset."</code>.</li>
<li>All exploration collapses to roughly 100 tokens.</li>
<li>Agent proceeds to implement the fix with a clean context.</li>
</ol>
<h2 id="mcp-tools">MCP Tools</h2>
<p>Swival can connect to external tool servers via the <a href="https://modelcontextprotocol.io/">Model Context Protocol</a> (MCP). MCP tools are discovered at startup and exposed alongside built-in tools. MCP tool output is size-guarded: results up to 20 KB are returned inline, larger results are saved to <code>.swival/</code> for paginated reads via <code>read_file</code>, and output is hard-capped at 10 MB. See <a href="mcp.html">MCP</a> for configuration and details.</p>
        </article>
    </div>
    <footer class="site-footer">
        MIT License &middot;
        <a href="https://github.com/swival/swival">GitHub</a>
    </footer>
</body>
</html>